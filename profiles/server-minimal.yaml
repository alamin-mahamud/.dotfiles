# Server Minimal Profile
# Minimal, secure configuration for production servers
# Focuses on essential tools, security hardening, and minimal resource usage

profile:
  name: "server-minimal"
  version: "1.0.0"
  description: "Minimal server configuration with essential tools and security hardening"
  author: "Dotfiles Project"
  environment: "server"
  target_os: ["linux"]
  target_distributions: ["ubuntu", "debian", "fedora", "centos", "rhel", "arch"]

# Core system components
components:
  # Core system functionality
  core:
    - "system_updates"
    - "essential_packages"
    - "user_management"
    - "timezone_config"
    - "locale_config"
  
  # Security hardening
  security:
    - "ssh_hardening"
    - "firewall_basic"
    - "fail2ban"
    - "audit_logging"

# Configuration variables
configuration:
  # System settings
  timezone: "UTC"
  locale: "en_US.UTF-8"
  
  # Security settings
  ssh_port: 22
  firewall_enable: true
  fail2ban_enable: true
  
  # User settings
  shell: "bash"
  editor: "vim"
  
  # Package management
  automatic_updates: true
  security_updates_only: true

# Post-installation scripts
post_install:
  - "echo 'Server minimal profile installation completed'"
  - "systemctl --failed"  # Show any failed services
  - "df -h"  # Show disk usage

# Validation checks
validation:
  required_commands:
    - "git"
    - "curl"
    - "wget"
    - "ssh"
    - "sudo"
  
  required_services:
    - "ssh"
    - "systemd-resolved"
  
  security_checks:
    - "ufw_enabled"
    - "fail2ban_active"
    - "ssh_key_auth"

# Documentation
documentation:
  description: |
    This profile provides a minimal, secure foundation for production servers.
    It focuses on essential system tools, security hardening, and automated updates
    while maintaining a small resource footprint.
    
    Components installed:
    - Essential system packages (git, curl, etc.)
    - Security hardening (SSH, firewall, fail2ban)
    - System monitoring basics
    - Automated security updates
    
    After installation:
    - SSH is hardened with key-based authentication
    - Firewall is configured with minimal open ports
    - Intrusion detection is active
    - System logs are properly configured
    
  usage: |
    Deploy this profile on:
    - Production servers
    - VPS instances
    - Cloud compute instances
    - Minimal development environments
    
    Not suitable for:
    - Desktop environments
    - Development workstations
    - Containers (security components may not work)
    
  maintenance: |
    Regular maintenance tasks:
    - Monitor fail2ban logs: sudo fail2ban-client status
    - Check system updates: sudo apt list --upgradable
    - Review security logs: sudo journalctl -p warning --since "1 hour ago"
    - Verify SSH configuration: sudo sshd -t